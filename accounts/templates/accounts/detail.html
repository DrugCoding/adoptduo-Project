{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
<link rel="stylesheet" href="{% static 'css/account_detail.css' %}">

<div style="background-color: rgb(247, 247, 247); height:500px;">
  <div class="container d-flex flex-row justify-content-center py-5">
    <div class="col-4" style="max-width: 1080px; max-height: 404px; margin-right:4px; background-color: white;">
      <!-- 프로필 -->
      <div class="p-3">
        <!-- 프사 -->
        <div class="d-flex justify-content-center mb-3">
          {% if user.image %}
          <img src="{{ user.image.url }}" style='width: 180px; height: 180px; border-radius: 2rem; object-fit: cover;'
            alt="">
          {% else %}
          <img
            src="https://cdn.discordapp.com/attachments/1044493548071948309/1049236425708666940/review_default_profile_image.jpg"
            style='width: 180px; height: 180px; border-radius: 2rem; object-fit: cover;' alt="더미프사">
          {% endif %}
        </div>
        <h4 class="text-center fw-bold my-4">{{ user.name }}님의 프로필</h4>
        <!-- 팔로잉 팔로워 -->
        <div class="row mb-3">
          <div class="col" style="height: 60px;">
            <p class="mb-1 text-center" style="color: grey">팔로워</p>
            <p class="fw-bold text-center">{{ user.followers.count }}</p>
          </div>
          <div class="col border-start" style="height: 60px;">
            <p class="mb-1 text-center" style=" color: grey">팔로잉</p>
            <p class="fw-bold text-center">{{ user.followings.count }}</p>
          </div>
        </div>
        <!-- 버튼 -->
        <div>
          {% if request.user != user %}
          <a href="{% url 'accounts:follow' user.pk %}">
            {% if request.user in user.followers.all %}
            <button class="btn" style="width: 100%; margin:0 auto;">팔로우 취소</button>
            {% else %}
            <button class="btn" style="width: 100%; margin:0 auto;">팔로우</button>
            {% endif %}
          </a>
          {% else %}
          <a href="{% url 'accounts:update' %}"><button class="btn" style="width: 100%; margin:0 auto;">프로필
              수정</button></a>
          {% endif %}
        </div>

      </div>
    </div>
    <div class="col-9">
      <section class="d-flex flex-column" style="gap: 4px">
        <div class="d-flex d-grid" style="width: 100%; height: 100%; gap: 4px;">
          <div style="width:320px; height:200px; background-color: white; padding:30px 30px;">
            <p class="m-0">거주지</p>
            <p class="m-0" style="font-size: 20px; color:#d7ac00; font-weight: 600;">
              {{ user.area }}
            </p>
          </div>
          <div style="width:320px; height:200px; background-color: white; padding:30px 30px;">
            <p class="m-0">이동봉사
            </p>
            <p class="m-0" style="font-size: 20px; color:#d7ac00; font-weight: 600;">
              {{ user.volunteer_c }}
            </p>
          </div>
          <div style="width:320px; height:200px; background-color: white; padding:30px 30px;">
            <p class="m-0">이메일</p>
            <p class="m-0" style="font-size: 20px; color:#d7ac00; font-weight: 600;">
              {{ user.email }}
          </div>
        </div>
        <div class="d-flex d-grid" style="width: 100%; height: 100%; gap: 4px;">
          <div class="d-flex flex-column"
            style="width:482px; height:200PX; background-color: white; padding: 30px 30px;">
            <p class="m-0">작성글</p>
            {% if user.dogarticle_set %}
            <p class="m-0" style="font-size: 22px; color:#d7ac00; font-weight: 600;">
              {{ user.dogarticle_set.count|add:user.catarticle_set.count|add:user.stories_set.count }}
              <span style="font-size: 1rem;">개</span>
            </p>
            {% elif user.catarticle_set %}
            <p class="m-0" style="font-size: 22px; color:#d7ac00; font-weight: 600;">
              {{ user.dogarticle_set.count|add:user.catarticle_set.count|add:user.stories_set.count }}
              <span style="font-size: 1rem;">개</span>
            </p>
            {% elif user.stories_set %}
            <p class="m-0" style="font-size: 22px; color:#d7ac00; font-weight: 600;">
              {{ user.dogarticle_set.count|add:user.catarticle_set.count|add:user.stories_set.count }}
              <span style="font-size: 1rem;">개</span>
            </p>
            {% else %}
            <p class="m-0" style="font-size: 22px; color:#d7ac00; font-weight: 600;">
              0<span style="font-size: 1rem;">개</span>
            </p>
            {% endif %}
          </div>
          <div class="d-flex flex-column"
            style="width:482px; height:200PX; background-color: white; padding: 30px 30px;">
            <p class="m-0">작성댓글</p>
            {% if user.dogarticle_comment_set %}
            <p class="m-0" style="font-size: 22px; color:#d7ac00; font-weight: 600;">
              {{ user.dogarticle_comment_set.count }}
              <span style="font-size: 1rem;">개</span>
            </p>
            {% else %}
            <p class="m-0" style="font-size: 22px; color:#d7ac00; font-weight: 600;">
              0<span style="font-size: 1rem;">개</span>
            </p>
            {% endif %}
          </div>
        </div>
      </section>
    </div>
  </div>
</div>

{% if request.user != user %}
<div></div>

{% else %}
<div class="d-flex flex-column justify-content-center align-items-center my-5">
  <div class="d-flex flex-column justify-content-center align-items-center my-5">
    <h4 class="fw-bold">🐶 북마크한 강아지 글 🐶</h4>
    <div class="my-5 bookmark-list">
      {% for dog_article in user.dogarticle_bookmark.all %}
      <div class="bookmark-card" style="cursor: pointer;">
        <div class="bookmark-content">
          <div>
            <a href="{% url 'articles:dog_detail' dog_article.pk %}" style="text-decoration: none; color: black;">
              <h3 class="mb-3">{{ dog_article.title }}</h3>
              <p class="mt-3">작성자 : {{ dog_article.user.username }}</p>
              <p>{{ dog_article.content |truncatechars:20 |safe }}</p>
              <p>특이사항 : {{ dog_article.memo }}</p>
              <a href="" style="color: #2478FF; text-decoration: none;">
                #{{ dog_article.location}}
                #{{ dog_article.age }}
                #{{ dog_article.gender }}
                #{{ dog_article.dog_breed }}
              </a>
              <div class="mt-3 d-flex">
                <p class="me-4" style="color: gray;"><i class="bi bi-eye"></i>
                  {{ dog_article.hits }}</p>
                <p class="me-4" style="color: gray;"><i class="bi bi-hand-thumbs-up"></i>
                  {{ dog_article.like.all | length }}</p>
                <p style="color: gray;">{{ dog_article.created_at | timesince }}</p>
              </div>
            </a>
          </div>
          <a href="{% url 'articles:dog_detail' dog_article.pk %}"><img src="{{ dog_article.image.url }}" alt=""
              style="width: 150px; height: 150px; object-fit: cover;"></a>
        </div>
      </div>
      </a>
      {% endfor %}
    </div>
  </div>

  <div class="d-flex flex-column justify-content-center align-items-center my-5">
    <h4 class="fw-bold">😺 북마크한 고양이 글 😺</h4>
    <div class="my-5 bookmark-list">
      {% for cat_article in user.catarticle_bookmark.all %}
      <div class="bookmark-card" style="cursor: pointer;">
        <div class="bookmark-content">
          <div>
            <a href="{% url 'articles:cat_detail' cat_article.pk %}" style="text-decoration: none; color: black;">
              <h3 class="mb-3">{{ cat_article.title }}</h3>
              <p class="mt-3">작성자 : {{ cat_article.user.username }}</p>
              <p>{{ cat_article.content |truncatechars:20 |safe }}</p>
              <p>특이사항 : {{ cat_article.memo }}</p>
              <a href="" style="color: #2478FF; text-decoration: none;">
                #{{ cat_article.location}}
                #{{ cat_article.age }}
                #{{ cat_article.gender }}
                #{{ cat_article.cat_breed }}
              </a>
              <div class="mt-3 d-flex">
                <p class="me-4" style="color: gray;"><i class="bi bi-eye"></i>
                  {{ cat_article.hits }}</p>
                <p class="me-4" style="color: gray;"><i class="bi bi-hand-thumbs-up"></i>
                  {{ cat_article.like.all | length }}</p>
                <p style="color: gray;">{{ cat_article.created_at | timesince }}</p>
              </div>
            </a>

          </div>
          <a href="{% url 'articles:cat_detail' cat_article.pk %}"><img src="{{ cat_article.image.url }}" alt=""
              style="width: 150px; height: 150px; object-fit: cover;"></a>
        </div>
      </div>
      </a>
      {% endfor %}
    </div>
  </div>
</div>
{% endif %}

{% endblock content %}